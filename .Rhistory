View(t)
View(b)
View(c)
View(b)
View(c)
a <- res_e %>% dplyr::select(`년도`, `시도`, `학교`,  `학교_학년`,`체력요인`, `선택종목`,`학교명`,`성별`) %>%
dplyr::filter(`년도` >= 2011) %>%
dplyr::arrange(`년도`, `시도`, `학교`,  `학교_학년`,`체력요인`, `선택종목`,`학교명`,`성별` ) %>%
group_by(`년도`, `시도`, `학교`,  `학교_학년`,`체력요인`, `선택종목`,`학교명`) %>%
slice_head(n = 1) %>%
ungroup() %>%
group_by(`년도`, `학교_학년`,`체력요인`, `선택종목`) %>%
summarise( 학교수 =n())   %>%
pivot_wider(names_from = c(`선택종목`, `체력요인`), values_from = `학교수`)
b <- res_m %>% dplyr::select(`년도`, `시도`, `학교`,  `학교_학년`,`체력요인`, `선택종목`,`학교명`,`성별`) %>%
dplyr::filter(`년도` >= 2011) %>%
dplyr::arrange(`년도`, `시도`, `학교`,  `학교_학년`,`체력요인`, `선택종목`,`학교명`,`성별` ) %>%
group_by(`년도`, `시도`, `학교`,  `학교_학년`,`체력요인`, `선택종목`,`학교명`) %>%
slice_head(n = 1) %>%
ungroup() %>%
group_by(`년도`, `학교_학년`,`체력요인`, `선택종목`) %>%
summarise( 학교수 =n())   %>%
pivot_wider(names_from = c(`선택종목`, `체력요인`), values_from = `학교수`)
c <- res_h %>% dplyr::select(`년도`, `시도`, `학교`,  `학교_학년`,`체력요인`, `선택종목`,`학교명`,`성별`) %>%
dplyr::filter(`년도` >= 2011) %>%
dplyr::arrange(`년도`, `시도`, `학교`,  `학교_학년`,`체력요인`, `선택종목`,`학교명`,`성별` ) %>%
group_by(`년도`, `시도`, `학교`,  `학교_학년`,`체력요인`, `선택종목`,`학교명`) %>%
slice_head(n = 1) %>%
ungroup() %>%
group_by(`년도`, `학교_학년`,`체력요인`, `선택종목`) %>%
summarise( 학교수 =n())   %>%
pivot_wider(names_from = c(`선택종목`, `체력요인`), values_from = `학교수`)
t <- rbind(a,b,c) %>% dplyr::arrange(`년도`, `학교_학년`)
View(t)
t1 <- rbind(a,b,c) %>% dplyr::arrange(`년도`, `학교_학년`)
t2 <- rbind(a,b,c) %>% dplyr::arrange( `학교_학년`, `년도`)
View(t2)
a <- res_e %>% dplyr::select(`년도`, `시도`, `학교`,`체력요인`, `선택종목`,`학교명`,`성별`, `학교_학년`) %>%
dplyr::filter(`년도` >= 2011) %>%
dplyr::arrange(`년도`, `시도`, `학교`,`체력요인`, `선택종목`,`학교명`,`성별`, `학교_학년` ) %>%
group_by(`년도`, `시도`, `학교`, `체력요인`, `선택종목`,`학교명`) %>%
slice_head(n = 1) %>%
ungroup() %>%
group_by(`년도`, `학교`,`체력요인`, `선택종목`) %>%
summarise( 학교수 =n())   %>%
pivot_wider(names_from = c(`선택종목`, `체력요인`), values_from = `학교수`)
b <- res_m %>% dplyr::select(`년도`, `시도`, `학교`,`체력요인`, `선택종목`,`학교명`,`성별`, `학교_학년`) %>%
dplyr::filter(`년도` >= 2011) %>%
dplyr::arrange(`년도`, `시도`, `학교`,`체력요인`, `선택종목`,`학교명`,`성별`, `학교_학년` ) %>%
group_by(`년도`, `시도`, `학교`, `체력요인`, `선택종목`,`학교명`) %>%
slice_head(n = 1) %>%
ungroup() %>%
group_by(`년도`, `학교`,`체력요인`, `선택종목`) %>%
summarise( 학교수 =n())   %>%
pivot_wider(names_from = c(`선택종목`, `체력요인`), values_from = `학교수`)
c <- res_h %>% dplyr::select(`년도`, `시도`, `학교`,`체력요인`, `선택종목`,`학교명`,`성별`, `학교_학년`) %>%
dplyr::filter(`년도` >= 2011) %>%
dplyr::arrange(`년도`, `시도`, `학교`,`체력요인`, `선택종목`,`학교명`,`성별`, `학교_학년` ) %>%
group_by(`년도`, `시도`, `학교`, `체력요인`, `선택종목`,`학교명`) %>%
slice_head(n = 1) %>%
ungroup() %>%
group_by(`년도`, `학교`,`체력요인`, `선택종목`) %>%
summarise( 학교수 =n())   %>%
pivot_wider(names_from = c(`선택종목`, `체력요인`), values_from = `학교수`)
s1 <- rbind(a,b,c) %>% dplyr::arrange(`년도`, `학교`)
s2 <- rbind(a,b,c) %>% dplyr::arrange( `학교`, `년도`)
View(s1)
View(s2)
s2 <- rbind(a,b,c) %>% dplyr::relocate(`학교`) %>% dplyr::arrange( `학교`, `년도`)
View(s2)
View(s2)
a <- res_e %>% dplyr::select(`년도`, `시도`, `학교`,`체력요인`, `선택종목`,`학교명`,`성별`, `학교_학년`) %>%
dplyr::filter(`년도` >= 2011) %>%
dplyr::arrange(`년도`, `시도`, `학교`,`체력요인`, `선택종목`,`학교명`,`성별`, `학교_학년` ) %>%
group_by(`년도`, `시도`, `학교`, `체력요인`, `선택종목`,`학교명`) %>%
slice_head(n = 1) %>%
ungroup() %>%
group_by(`년도`, `학교`,`체력요인`, `선택종목`) %>%
summarise( 학교수 =n())   %>%
dplyr::mutate(p = `학교수` / sum(`학교수`))
View(a)
a <- res_e %>% dplyr::select(`년도`, `시도`, `학교`,`체력요인`, `선택종목`,`학교명`,`성별`, `학교_학년`) %>%
dplyr::filter(`년도` >= 2011) %>%
dplyr::arrange(`년도`, `시도`, `학교`,`체력요인`, `선택종목`,`학교명`,`성별`, `학교_학년` ) %>%
group_by(`년도`, `시도`, `학교`, `체력요인`, `선택종목`,`학교명`) %>%
slice_head(n = 1) %>%
ungroup() %>%
group_by(`년도`, `학교`,`체력요인`, `선택종목`) %>%
summarise( 학교수 =n())   %>%
dplyr::mutate(p = round(`학교수` *100 / sum(`학교수`),2))
pivot_wider(names_from = c(`선택종목`, `체력요인`), values_from = `학교수`)
View(a)
a1 <- a %>% dplyr::select(-비율)
a1 <- a %>% dplyr::select(-`비율`)
a <- res_e %>% dplyr::select(`년도`, `시도`, `학교`,`체력요인`, `선택종목`,`학교명`,`성별`, `학교_학년`) %>%
dplyr::filter(`년도` >= 2011) %>%
dplyr::arrange(`년도`, `시도`, `학교`,`체력요인`, `선택종목`,`학교명`,`성별`, `학교_학년` ) %>%
group_by(`년도`, `시도`, `학교`, `체력요인`, `선택종목`,`학교명`) %>%
slice_head(n = 1) %>%
ungroup() %>%
group_by(`년도`, `학교`,`체력요인`, `선택종목`) %>%
summarise( 학교수 =n())   %>%
dplyr::mutate(비율 = round(`학교수` *100 / sum(`학교수`),2))
View(a)
a1 <- a %>% dplyr::select(-`비율`) %>%
pivot_wider(names_from = c(`선택종목`, `체력요인`), values_from = `학교수`)
View(a_1)
a1 <- a %>% dplyr::select(-`비율`)
View(a1)
a1 <- a %>% dplyr::select(-`비율`)  %>%
pivot_wider(names_from = c(`선택종목`, `체력요인`), values_from = `학교수`)
View(a1)
a2 <- a %>% dplyr::select(-`학교수`)  %>%
pivot_wider(names_from = c(`선택종목`, `체력요인`), values_from = `비율`)
View(a2)
cal_percent_by_2 <- function(df){ }
cal_percent_by_2 <- function(df) {
a <-  df %>% dplyr::select(`년도`, `시도`, `학교`,`체력요인`, `선택종목`,`학교명`,`성별`, `학교_학년`) %>%
dplyr::filter(`년도` >= 2011) %>%
dplyr::arrange(`년도`, `시도`, `학교`,`체력요인`, `선택종목`,`학교명`,`성별`, `학교_학년` ) %>%
group_by(`년도`, `시도`, `학교`, `체력요인`, `선택종목`,`학교명`) %>%
slice_head(n = 1) %>%
ungroup() %>%
group_by(`년도`, `학교`,`체력요인`, `선택종목`) %>%
summarise( 학교수 =n())   %>%
dplyr::mutate(비율 = round(`학교수` *100 / sum(`학교수`),2))
pf_n <- a %>% dplyr::select(-`비율`)  %>%
pivot_wider(names_from = c(`선택종목`, `체력요인`), values_from = `학교수`)
df_p <- a %>% dplyr::select(-`학교수`)  %>%
pivot_wider(names_from = c(`선택종목`, `체력요인`), values_from = `비율`)
return(list(df_n, df_p))
}
a <- cal_percent_by_2(res_e)
b <- cal_percent_by_2(res_m)
c <- cal_percent_by_2(res_h)
View(a)
cal_percent_by_2 <- function(df) {
a <-  df %>% dplyr::select(`년도`, `시도`, `학교`,`체력요인`, `선택종목`,`학교명`,`성별`, `학교_학년`) %>%
dplyr::filter(`년도` >= 2011) %>%
dplyr::arrange(`년도`, `시도`, `학교`,`체력요인`, `선택종목`,`학교명`,`성별`, `학교_학년` ) %>%
group_by(`년도`, `시도`, `학교`, `체력요인`, `선택종목`,`학교명`) %>%
slice_head(n = 1) %>%
ungroup() %>%
group_by(`년도`, `학교`,`체력요인`, `선택종목`) %>%
summarise( 학교수 =n())   %>%
dplyr::mutate(비율 = round(`학교수` *100 / sum(`학교수`),2))
pf_n <- a %>% dplyr::select(-`비율`)  %>%
pivot_wider(names_from = c(`선택종목`, `체력요인`), values_from = `학교수`)
df_p <- a %>% dplyr::select(-`학교수`)  %>%
pivot_wider(names_from = c(`선택종목`, `체력요인`), values_from = `비율`)
return(list(df_n, df_p))
}
a <- cal_percent_by_2(res_e)
a
cal_percent_by_2 <- function(df) {
a <-  df %>% dplyr::select(`년도`, `시도`, `학교`,`체력요인`, `선택종목`,`학교명`,`성별`, `학교_학년`) %>%
dplyr::filter(`년도` >= 2011) %>%
dplyr::arrange(`년도`, `시도`, `학교`,`체력요인`, `선택종목`,`학교명`,`성별`, `학교_학년` ) %>%
group_by(`년도`, `시도`, `학교`, `체력요인`, `선택종목`,`학교명`) %>%
slice_head(n = 1) %>%
ungroup() %>%
group_by(`년도`, `학교`,`체력요인`, `선택종목`) %>%
summarise( 학교수 =n())   %>%
dplyr::mutate(비율 = round(`학교수` *100 / sum(`학교수`),2))
df_n <- a %>% dplyr::select(-`비율`)  %>%
pivot_wider(names_from = c(`선택종목`, `체력요인`), values_from = `학교수`)
df_p <- a %>% dplyr::select(-`학교수`)  %>%
pivot_wider(names_from = c(`선택종목`, `체력요인`), values_from = `비율`)
return(list(df_n, df_p))
}
a <- cal_percent_by_2(res_e)
b <- cal_percent_by_2(res_m)
c <- cal_percent_by_2(res_h)
tbl_1 <- rbind(a$df_n,b$df_n,c$df_n) %>% dplyr::arrange(`년도`, `학교`)
a$df_n
a
a[1]
a[[1]]
names(a)
tbl_1 <- rbind(a[[1]],b[[1]],c[[1]]) %>% dplyr::arrange(`년도`, `학교`)
tbl_2 <- rbind(a[[2]],b[[2]],c[[2]]) %>% dplyr::arrange(`학교`, `년도`)
View(tbl_1)
View(tbl_2)
View(tbl_1)
View(tbl_2)
tbl_1 <- rbind(a[[1]],b[[1]],c[[1]]) #%>% dplyr::arrange(`년도`, `학교`)
tbl_2 <- rbind(a[[2]],b[[2]],c[[2]]) #%>% dplyr::arrange(`학교`, `년도`)
View(tbl_1)
View(tbl_2)
cal_percent_by_2 <- function(df) {
a <-  df %>% dplyr::select(`년도`, `시도`, `학교`,`체력요인`, `선택종목`,`학교명`,`성별`, `학교_학년`) %>%
dplyr::filter(`년도` >= 2011) %>%
dplyr::arrange(`년도`, `시도`, `학교`,`체력요인`, `선택종목`,`학교명`,`성별`, `학교_학년` ) %>%
group_by(`년도`, `시도`, `학교`, `체력요인`, `선택종목`,`학교명`) %>%
slice_head(n = 1) %>%
ungroup() %>%
group_by(`년도`, `학교`,`체력요인`, `선택종목`) %>%
summarise( 학교수 =n())   %>%
dplyr::mutate(비율 = round(`학교수` *100 / sum(`학교수`),2))
df_n <- a %>% dplyr::select(-`비율`)  %>%
pivot_wider(names_from = c(`선택종목`, `체력요인`), values_from = `학교수`) %>%
dplyr::relocate(`학교`)
df_p <- a %>% dplyr::select(-`학교수`)  %>%
pivot_wider(names_from = c(`선택종목`, `체력요인`), values_from = `비율`)  %>%
dplyr::relocate(`학교`)
return(list(df_n, df_p))
}
a <- cal_percent_by_2(res_e)
b <- cal_percent_by_2(res_m)
c <- cal_percent_by_2(res_h)
tbl_1 <- rbind(a[[1]],b[[1]],c[[1]]) #%>% dplyr::arrange(`년도`, `학교`)
tbl_2 <- rbind(a[[2]],b[[2]],c[[2]]) #%>% dplyr::arrange(`학교`, `년도`)
View(tbl_1)
View(tbl_2)
?save.image
knitr::opts_chunk$set(echo = FALSE, warning=FALSE, message=FALSE)
library(here)           # file pathways
source(here::here("_common", "common.R"))
source(here::here("_common", "preprocess.R"))
knitr::opts_chunk$set(echo = FALSE, warning=FALSE, message=FALSE)
library(here)           # file pathways
source(here::here("_common", "common.R"))
source(here::here("_common", "preprocess.R"))
#| message : FALSE
#| warning : FALSE
res_e_1 <- summ_by_school_3var(df_e_01, SHLR_NTS, MIN_SEC_LRW_HR, PEI_NMVL, "초등학교", "심폐지구력")
res_e_2 <- summ_by_school_2var(df_e_01, BKRCH_NMVL, GNRLZ_FLX_NMVL, "초등학교", "유연성")
res_e_3 <- summ_by_school_3var(df_e_01, PSP_NTS, CLUP_NTS, GRIP_NMVL, "초등학교", "근지구력")
res_e_4 <- summ_by_school_2var(df_e_01, R50M_REC_HR, SLJ_NMVL, "초등학교", "순발력")
res_e_1 <- res_e_1 %>% dplyr::filter(`학년` >= 5)   # 5학년 이상
res_e_2 <- res_e_2 %>% dplyr::filter(`학년` >= 5)   # 5학년 이상
res_e_3 <- res_e_3 %>% dplyr::filter(`학년` >= 5)   # 5학년 이상
res_e_4 <- res_e_4 %>% dplyr::filter(`학년` >= 5)   # 5학년 이상
#| message : FALSE
#| warning : FALSE
res_m_1 <- summ_by_school_3var(df_m_01, SHLR_NTS, MIN_SEC_LRW_HR, PEI_NMVL, "중학교", "심폐지구력")
res_m_2 <- summ_by_school_2var(df_m_01, BKRCH_NMVL, GNRLZ_FLX_NMVL, "중학교", "유연성")
res_m_3 <- summ_by_school_3var(df_m_01, PSP_NTS, CLUP_NTS, GRIP_NMVL, "중학교", "근지구력")
res_m_4 <- summ_by_school_2var(df_m_01, R50M_REC_HR, SLJ_NMVL, "중학교", "순발력")
#| message : FALSE
#| warning : FALSE
res_h_1 <- summ_by_school_3var(df_h_01, SHLR_NTS, MIN_SEC_LRW_HR, PEI_NMVL, "고등학교", "심폐지구력")
res_h_2 <- summ_by_school_2var(df_h_01, BKRCH_NMVL, GNRLZ_FLX_NMVL, "고등학교", "유연성")
res_h_3 <- summ_by_school_3var(df_h_01, PSP_NTS, CLUP_NTS, GRIP_NMVL, "고등학교", "근지구력")
res_h_4 <- summ_by_school_2var(df_h_01, R50M_REC_HR, SLJ_NMVL, "고등학교", "순발력")
res_e <- rbind(res_e_1, res_e_2, res_e_3, res_e_4)
res_m <- rbind(res_m_1, res_m_2, res_m_3, res_m_4)
res_h <- rbind(res_h_1, res_h_2, res_h_3, res_h_4)
data_for_save <- list(res_e, res_m, res_h)
save.image(data_for_save, file=here("data","Rdata","paps_mean.Rdata"))
data_for_save1 <- rbind(res_e, res_m, res_h)
View(data_for_save1)
write_feather(data_for_save1, here("data","feather","paps_mean.feather"))
rm(list = ls())
dirpath <- here("data","feather","paps_mean.feather")
df_m <- read_feather(dirpath, col_select = NULL, as_data_frame = TRUE, mmap = TRUE)
a <- cal_percent_by_2(df_m)
knitr::opts_chunk$set(echo = FALSE, warning=FALSE, message=FALSE)
library(here)           # file pathways
source(here::here("_common", "common.R"))
source(here::here("_common", "preprocess.R"))
a <- cal_percent_by_2(df_m)
tbl_1 <- a[[1]]
tbl_2 <- a[[2]]
View(tbl_1)
cal_percent_by_2 <- function(df) {
a <-  df %>% dplyr::select(`년도`, `시도`, `학교`,`체력요인`, `선택종목`,`학교명`,`성별`, `학교_학년`) %>%
dplyr::filter(`년도` >= 2011) %>%
dplyr::arrange(`년도`, `시도`, `학교`,`체력요인`, `선택종목`,`학교명`,`성별`, `학교_학년` ) %>%
group_by(`년도`, `시도`, `학교`, `체력요인`, `선택종목`,`학교명`) %>%
slice_head(n = 1) %>%
ungroup() %>%
group_by(`년도`, `학교`,`체력요인`, `선택종목`) %>%
summarise( 학교수 =n())   %>%
dplyr::mutate(비율 = round(`학교수` *100 / sum(`학교수`),2))
df_n <- a %>% dplyr::select(-`비율`)  %>%
dplyr::arrange(`학교`,`년도`) %>%
pivot_wider(names_from = c(`선택종목`, `체력요인`), values_from = `학교수`) %>%
dplyr::relocate(`학교`)
df_p <- a %>% dplyr::select(-`학교수`)  %>%
dplyr::arrange(`학교`,`년도`) %>%
pivot_wider(names_from = c(`선택종목`, `체력요인`), values_from = `비율`)  %>%
dplyr::relocate(`학교`)
return(list(df_n, df_p))
}
a <- cal_percent_by_2(df_m)
tbl_1 <- a[[1]]
tbl_2 <- a[[2]]
View(tbl_1)
View(tbl_2)
tbl_0 <- cal_percent_by_2(df_m)
#| echo : FALSE
#| warning : FALSE
#| message : FALSE
tbl_e_n <- a[[1]] %>% dplyr::filter(`학교` == '초등학교')
tbl_e_p <- a[[2]] %>% dplyr::filter(`학교` == '초등학교')
#| echo : FALSE
#| warning : FALSE
#| message : FALSE
ft <- tbl_e_n |>
flextable() |>
separate_header() |>
autofit()  |>
fix_border_issues()
ft <- ft |>
theme_booktabs(bold_header = TRUE) |>
align(align = "center", part = "header", j = 3:8) |>
colformat_double(digits = 1)
ft
cal_percent_by_2 <- function(df) {
a <-  df %>% dplyr::select(`년도`, `시도`, `학교`,`체력요인`, `선택종목`,`학교명`,`성별`, `학교_학년`) %>%
dplyr::filter(`년도` >= 2011) %>%
dplyr::arrange(`년도`, `시도`, `학교`,`체력요인`, `선택종목`,`학교명`,`성별`, `학교_학년` ) %>%
group_by(`년도`, `시도`, `학교`, `체력요인`, `선택종목`,`학교명`) %>%
slice_head(n = 1) %>%
ungroup() %>%
group_by(`년도`, `학교`,`체력요인`, `선택종목`) %>%
summarise( 학교수 =n())   %>%
dplyr::mutate(비율 = round(`학교수` *100 / sum(`학교수`),2))
df_n <- a %>% dplyr::select(-`비율`)  %>%
dplyr::arrange(`학교`,`년도`) %>%
pivot_wider(names_from = c( `체력요인`, `선택종목`), values_from = `학교수`) %>%
dplyr::relocate(`학교`)
df_p <- a %>% dplyr::select(-`학교수`)  %>%
dplyr::arrange(`학교`,`년도`) %>%
pivot_wider(names_from = c(`체력요인`, `선택종목`), values_from = `비율`)  %>%
dplyr::relocate(`학교`)
return(list(df_n, df_p))
}
tbl_0 <- cal_percent_by_2(df_m)
head(tbl_0)
#| echo : FALSE
#| warning : FALSE
#| message : FALSE
tbl_e_n <- a[[1]] %>% dplyr::filter(`학교` == '초등학교')
tbl_e_p <- a[[2]] %>% dplyr::filter(`학교` == '초등학교')
#| echo : FALSE
#| warning : FALSE
#| message : FALSE
ft <- tbl_e_n |>
flextable() |>
separate_header() |>
autofit()  |>
fix_border_issues()
ft <- ft |>
theme_booktabs(bold_header = TRUE) |>
align(align = "center", part = "header", j = 3:8) |>
colformat_double(digits = 1)
ft
View(tbl_e_n)
#| echo : FALSE
#| warning : FALSE
#| message : FALSE
tbl_e_n <- a[[1]] %>% dplyr::filter(`학교` == '초등학교')
tbl_e_p <- a[[2]] %>% dplyr::filter(`학교` == '초등학교')
View(tbl_e_n)
#| echo : FALSE
#| warning : FALSE
#| message : FALSE
tbl_e_n <- tbl_0[[1]] %>% dplyr::filter(`학교` == '초등학교')
tbl_e_p <- tbl_0[[2]] %>% dplyr::filter(`학교` == '초등학교')
#| echo : FALSE
#| warning : FALSE
#| message : FALSE
ft <- tbl_e_n |>
flextable() |>
separate_header() |>
autofit()  |>
fix_border_issues()
ft <- ft |>
theme_booktabs(bold_header = TRUE) |>
align(align = "center", part = "header", j = 3:8) |>
colformat_double(digits = 1)
ft
#| echo : FALSE
#| warning : FALSE
#| message : FALSE
ft <- tbl_e_n |>
flextable() |>
separate_header() |>
autofit()  |>
fix_border_issues()
ft <- ft |>
theme_booktabs(bold_header = TRUE) |>
align(align = "center", part = "header", j = 3:12) |>
colformat_double(digits = 1)
ft
#| echo : FALSE
#| warning : FALSE
#| message : FALSE
ft <- tbl_e_p |>
flextable() |>
separate_header() |>
autofit()  |>
fix_border_issues()
ft <- ft |>
theme_booktabs(bold_header = TRUE) |>
align(align = "center", part = "header", j = 3:12) |>
colformat_double(digits = 1)
ft
# flextable option 설정
set_flextable_defaults(
font.size = 9,
padding.bottom = 3,
padding.top = 3,
padding.left = 3,
padding.right = 3
#post_process_docx = function(x){
#  theme_vanilla(x) %>%
#    set_table_properties(layout = "fixed")
#    autofit()
#}
)
#| echo : FALSE
#| warning : FALSE
#| message : FALSE
ft <- tbl_e_n |>
flextable() |>
separate_header() |>
autofit()  |>
fix_border_issues()
ft <- ft |>
theme_booktabs(bold_header = TRUE) |>
align(align = "center", part = "header", j = 3:12) |>
colformat_double(digits = 1)
ft
#| echo : FALSE
#| warning : FALSE
#| message : FALSE
ft <- tbl_e_p |>
flextable() |>
separate_header() |>
autofit()  |>
fix_border_issues()
ft <- ft |>
theme_booktabs(bold_header = TRUE) |>
align(align = "center", part = "header", j = 3:12) |>
colformat_double(digits = 1)
ft
# flextable option 설정
set_flextable_defaults(
font.size = 7,
padding.bottom = 3,
padding.top = 3,
padding.left = 3,
padding.right = 3
#post_process_docx = function(x){
#  theme_vanilla(x) %>%
#    set_table_properties(layout = "fixed")
#    autofit()
#}
)
#| echo : FALSE
#| warning : FALSE
#| message : FALSE
ft <- tbl_e_n |>
flextable() |>
separate_header() |>
autofit()  |>
fix_border_issues()
ft <- ft |>
theme_booktabs(bold_header = TRUE) |>
align(align = "center", part = "header", j = 3:12) |>
colformat_double(digits = 1)
ft
# flextable option 설정
set_flextable_defaults(
font.size = 8,
padding.bottom = 3,
padding.top = 3,
padding.left = 3,
padding.right = 3
#post_process_docx = function(x){
#  theme_vanilla(x) %>%
#    set_table_properties(layout = "fixed")
#    autofit()
#}
)
#| echo : FALSE
#| warning : FALSE
#| message : FALSE
ft <- tbl_e_n |>
flextable() |>
separate_header() |>
autofit()  |>
fix_border_issues()
ft <- ft |>
theme_booktabs(bold_header = TRUE) |>
align(align = "center", part = "header", j = 3:12) |>
colformat_double(digits = 1)
ft
str(tbl_e_n)
tbl_e_n$년도
year(tbl_e_n$년도)
as.year(tbl_e_n$년도)
make_table_2 <- function(df) {
table_col <- colnames(df)
ft <- df |> dplyr::group_by(`학교`) |>
dplyr::mutate(is_last_val_in_group = row_number() == max(row_number())) |>
flextable(col_keys = table_col ) |>
merge_v( j = 1 ) |>
valign(j = 1, valign = "top") |>
#autofit()  |>
theme_booktabs(bold_header = TRUE) |>
align(align = "right", part = "header", j =3:5) |>
colformat_double(digits = 1) |>
hline(i = ~is_last_val_in_group == TRUE, border = fp_border()) |>
width(j = 3:5, 1, unit = "in") |>
fix_border_issues()
ft
}
make_table_2(tbl_e_n)
