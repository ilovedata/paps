source(here::here("_common", "preprocess.R"))
#| waring : FALSE
#| message : FALSE
aa <- summ_by_item_1var(df_e_01, PEI_NMVL, "초등학교", "스텝검사")
bb <- summ_by_item_1var(df_m_01, PEI_NMVL, "중학교", "스텝검사")
cc <- summ_by_item_1var(df_h_01, PEI_NMVL, "고등학교", "스텝검사")
pp <- combine_summ_by_item_1var(aa[[1]], bb[[1]], cc[[1]], "스텝검사")
k <- barplot_by_item_1var_year(PEI_NMVL, "스텝검사")
pp[[3]]
if(isword) cat("\n", wordnewpage, "\n")
pp[[1]]
if(isword) cat("\n", wordnewpage, "\n")
pp[[4]]
if(isword) cat("\n", wordnewpage, "\n")
pp[[2]]
if(isword) cat("\n", wordnewpage, "\n")
k
source("~/Library/CloudStorage/Dropbox/working/PAPS_2023/report/_common/preprocess.R", echo=TRUE)
knitr::opts_chunk$set(echo = FALSE, warning=FALSE, message=FALSE)
library(here)           # file pathways
source(here::here("_common", "common.R"))
source(here::here("_common", "preprocess.R"))
#| waring : FALSE
#| message : FALSE
aa <- summ_by_item_1var(df_e_01, PEI_NMVL, "초등학교", "스텝검사")
bb <- summ_by_item_1var(df_m_01, PEI_NMVL, "중학교", "스텝검사")
cc <- summ_by_item_1var(df_h_01, PEI_NMVL, "고등학교", "스텝검사")
pp <- combine_summ_by_item_1var(aa[[1]], bb[[1]], cc[[1]], "스텝검사")
k <- barplot_by_item_1var_year(PEI_NMVL, "스텝검사")
pp[[3]]
if(isword) cat("\n", wordnewpage, "\n")
pp[[1]]
if(isword) cat("\n", wordnewpage, "\n")
pp[[4]]
if(isword) cat("\n", wordnewpage, "\n")
pp[[2]]
if(isword) cat("\n", wordnewpage, "\n")
k
g_m <- df %>% dplyr::filter(성별 == '남성') %>%
ggplot(aes(x = `년도`, y = `평균`, group = `학교_학년`, color = `학교_학년`, shape= `학교_학년`)) +
geom_line(alpha = 0.3) +
geom_point(size=1.5) +
scale_shape_manual(values = c(15,16,15,16,17,15,16,17)) +
labs(title = paste(test_char,"-남성"),  x = "년도", y = "평균") +
theme_bw() +
theme(legend.position = "bottom",
axis.text=element_text(size=18),
axis.title=element_text(size=18),
legend.text=element_text(size=18,face="bold"),
legend.title=element_text(size=18,face="bold"))
knitr::opts_chunk$set(echo = FALSE, warning=FALSE, message=FALSE)
library(here)           # file pathways
source(here::here("_common", "common.R"))
source(here::here("_common", "preprocess.R"))
#| waring : FALSE
#| message : FALSE
aa <- summ_by_item_1var(df_e_01, PEI_NMVL, "초등학교", "스텝검사")
bb <- summ_by_item_1var(df_m_01, PEI_NMVL, "중학교", "스텝검사")
cc <- summ_by_item_1var(df_h_01, PEI_NMVL, "고등학교", "스텝검사")
pp <- combine_summ_by_item_1var(aa[[1]], bb[[1]], cc[[1]], "스텝검사")
k <- barplot_by_item_1var_year(PEI_NMVL, "스텝검사")
pp[[3]]
if(isword) cat("\n", wordnewpage, "\n")
pp[[1]]
if(isword) cat("\n", wordnewpage, "\n")
pp[[4]]
if(isword) cat("\n", wordnewpage, "\n")
pp[[2]]
if(isword) cat("\n", wordnewpage, "\n")
k
View(var_paps_info)
knitr::opts_chunk$set(echo = FALSE, warning=FALSE, message=FALSE)
library(here)           # file pathways
source(here::here("_common", "common.R"))
source(here::here("_common", "preprocess.R"))
dirpath <- here("data","feather","paps_mean.feather")
df_sch_mean <- read_feather(dirpath, col_select = NULL, as_data_frame = TRUE, mmap = TRUE)
df_sch_mean <- df_sch_mean %>% dplyr::filter(`년도` >= 2011 )
df_sch_mean$`년도` <-  factor(df_sch_mean$`년도`)
#| echo: false
#| warning: false
a01 <- df_sch_mean %>%
dplyr::filter( `성별` == "여성") %>%
group_by(`선택종목`, `년도`, `학교_학년`) %>%
summarize( 전국평균 = weighted.mean(`평균`,`학생수`),.groups = 'drop') %>%
dplyr::filter(!is.na(학교_학년))
birthyear <- a01  %>%
mutate(생년 = case_when(
`학교_학년` == "초등학교_5" ~ 2010  + as.numeric(년도) -11,
`학교_학년` == "초등학교_6" ~ 2010  + as.numeric(년도) - 12,
`학교_학년` == "중학교_1" ~ 2010  + as.numeric(년도) - 13,
`학교_학년` == "중학교_2" ~ 2010  + as.numeric(년도) - 14,
`학교_학년` == "중학교_3" ~ 2010  + as.numeric(년도) - 15,
`학교_학년` == "고등학교_1" ~ 2010  + as.numeric(년도) - 16,
`학교_학년` == "고등학교_2" ~ 2010  + as.numeric(년도) - 17,
`학교_학년` == "고등학교_3" ~ 2010  + as.numeric(년도) - 18,
.default =NA )) %>%
dplyr::mutate(생년 = factor(생년)) %>%
dplyr::select(-`년도`) %>%
dplyr::relocate(생년, .before = `학교_학년`) %>%
dplyr::arrange(`선택종목`, `생년`, `학교_학년`) %>%
dplyr::filter(생년 %in% c("2000","2001","2002","2003","2004"))#,"2005","2006","2007","2008","2009"))
birthyear_w<- birthyear %>%  pivot_wider(names_from = `학교_학년`, values_from = 전국평균)
write.xlsx(birthyear_w, file = here("data","outputs","birthyear_item_mean_female.xlsx"))
#| echo: false
#| warning: false
tvar <- test_item_levels[1]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar,"여성" )
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[2]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar,"여성" )
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[3]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar ,"여성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[4]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar ,"여성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[5]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar ,"여성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[6]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar ,"여성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[7]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar ,"여성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[8]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar,"여성" )
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[9]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar,"여성" )
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[10]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar ,"여성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[11]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar ,"여성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[12]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar ,"여성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[13]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar ,"여성")
res[[1]]
res[[2]]
knitr::opts_chunk$set(echo = FALSE, warning=FALSE, message=FALSE)
library(here)           # file pathways
source(here::here("_common", "common.R"))
source(here::here("_common", "preprocess.R"))
dirpath <- here("data","feather","paps_mean.feather")
df_sch_mean <- read_feather(dirpath, col_select = NULL, as_data_frame = TRUE, mmap = TRUE)
df_sch_mean <- df_sch_mean %>% dplyr::filter(`년도` >= 2011 )
df_sch_mean$`년도` <-  factor(df_sch_mean$`년도`)
#| echo: false
#| warning: false
a01 <- df_sch_mean %>%
dplyr::filter( `성별` == "남성") %>%
group_by(`선택종목`, `년도`, `학교_학년`) %>%
summarize( 전국평균 = weighted.mean(`평균`,`학생수`),.groups = 'drop') %>%
dplyr::filter(!is.na(학교_학년))
birthyear <- a01  %>%
mutate(생년 = case_when(
`학교_학년` == "초등학교_5" ~ 2010  + as.numeric(년도) -11,
`학교_학년` == "초등학교_6" ~ 2010  + as.numeric(년도) - 12,
`학교_학년` == "중학교_1" ~ 2010  + as.numeric(년도) - 13,
`학교_학년` == "중학교_2" ~ 2010  + as.numeric(년도) - 14,
`학교_학년` == "중학교_3" ~ 2010  + as.numeric(년도) - 15,
`학교_학년` == "고등학교_1" ~ 2010  + as.numeric(년도) - 16,
`학교_학년` == "고등학교_2" ~ 2010  + as.numeric(년도) - 17,
`학교_학년` == "고등학교_3" ~ 2010  + as.numeric(년도) - 18,
.default =NA )) %>%
dplyr::mutate(생년 = factor(생년)) %>%
dplyr::select(-`년도`) %>%
dplyr::relocate(생년, .before = `학교_학년`) %>%
dplyr::arrange(`선택종목`, `생년`, `학교_학년`) %>%
dplyr::filter(생년 %in% c("2000","2001","2002","2003","2004")) #,"2005","2006","2007","2008","2009"))
birthyear_w<- birthyear %>%  pivot_wider(names_from = `학교_학년`, values_from = 전국평균)
write.xlsx(birthyear_w, file = here("data","outputs","birthyear_item_mean_male.xlsx"))
#| echo: false
#| warning: false
tvar <- test_item_levels[1]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar ,"남성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[2]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar  ,"남성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[3]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar  ,"남성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[4]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar  ,"남성" )
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[5]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar  ,"남성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[6]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar  ,"남성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[7]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar  ,"남성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[8]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar  ,"남성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[9]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar  ,"남성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[10]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar ,"남성" )
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[11]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar  ,"남성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[12]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar  ,"남성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[13]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar  ,"남성")
res[[1]]
res[[2]]
knitr::opts_chunk$set(echo = FALSE, warning=FALSE, message=FALSE)
library(here)           # file pathways
source(here::here("_common", "common.R"))
source(here::here("_common", "preprocess.R"))
dirpath <- here("data","feather","paps_mean.feather")
df_sch_mean <- read_feather(dirpath, col_select = NULL, as_data_frame = TRUE, mmap = TRUE)
df_sch_mean <- df_sch_mean %>% dplyr::filter(`년도` >= 2011 )
df_sch_mean$`년도` <-  factor(df_sch_mean$`년도`)
#| echo: false
#| warning: false
a01 <- df_sch_mean %>%
dplyr::filter( `성별` == "남성") %>%
group_by(`선택종목`, `년도`, `학교_학년`) %>%
summarize( 전국평균 = weighted.mean(`평균`,`학생수`),.groups = 'drop') %>%
dplyr::filter(!is.na(학교_학년))
birthyear <- a01  %>%
mutate(생년 = case_when(
`학교_학년` == "초등학교_5" ~ 2010  + as.numeric(년도) -11,
`학교_학년` == "초등학교_6" ~ 2010  + as.numeric(년도) - 12,
`학교_학년` == "중학교_1" ~ 2010  + as.numeric(년도) - 13,
`학교_학년` == "중학교_2" ~ 2010  + as.numeric(년도) - 14,
`학교_학년` == "중학교_3" ~ 2010  + as.numeric(년도) - 15,
`학교_학년` == "고등학교_1" ~ 2010  + as.numeric(년도) - 16,
`학교_학년` == "고등학교_2" ~ 2010  + as.numeric(년도) - 17,
`학교_학년` == "고등학교_3" ~ 2010  + as.numeric(년도) - 18,
.default =NA )) %>%
dplyr::mutate(생년 = factor(생년)) %>%
dplyr::select(-`년도`) %>%
dplyr::relocate(생년, .before = `학교_학년`) %>%
dplyr::arrange(`선택종목`, `생년`, `학교_학년`) %>%
dplyr::filter(생년 %in% c("2000","2001","2002","2003","2004")) #,"2005","2006","2007","2008","2009"))
birthyear_w<- birthyear %>%  pivot_wider(names_from = `학교_학년`, values_from = 전국평균)
write.xlsx(birthyear_w, file = here("data","outputs","birthyear_item_mean_male.xlsx"))
#| echo: false
#| warning: false
tvar <- test_item_levels[1]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar ,"남성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[2]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar  ,"남성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[3]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar  ,"남성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[4]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar  ,"남성" )
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[5]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar  ,"남성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[6]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar  ,"남성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[7]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar  ,"남성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[8]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar  ,"남성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[9]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar  ,"남성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[10]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar ,"남성" )
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[11]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar  ,"남성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[12]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar  ,"남성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[13]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar  ,"남성")
res[[1]]
res[[2]]
knitr::opts_chunk$set(echo = FALSE, warning=FALSE, message=FALSE)
library(here)           # file pathways
source(here::here("_common", "common.R"))
source(here::here("_common", "preprocess.R"))
dirpath <- here("data","feather","paps_mean.feather")
df_sch_mean <- read_feather(dirpath, col_select = NULL, as_data_frame = TRUE, mmap = TRUE)
df_sch_mean <- df_sch_mean %>% dplyr::filter(`년도` >= 2011 )
df_sch_mean$`년도` <-  factor(df_sch_mean$`년도`)
#| echo: false
#| warning: false
a01 <- df_sch_mean %>%
dplyr::filter( `성별` == "여성") %>%
group_by(`선택종목`, `년도`, `학교_학년`) %>%
summarize( 전국평균 = weighted.mean(`평균`,`학생수`),.groups = 'drop') %>%
dplyr::filter(!is.na(학교_학년))
birthyear <- a01  %>%
mutate(생년 = case_when(
`학교_학년` == "초등학교_5" ~ 2010  + as.numeric(년도) -11,
`학교_학년` == "초등학교_6" ~ 2010  + as.numeric(년도) - 12,
`학교_학년` == "중학교_1" ~ 2010  + as.numeric(년도) - 13,
`학교_학년` == "중학교_2" ~ 2010  + as.numeric(년도) - 14,
`학교_학년` == "중학교_3" ~ 2010  + as.numeric(년도) - 15,
`학교_학년` == "고등학교_1" ~ 2010  + as.numeric(년도) - 16,
`학교_학년` == "고등학교_2" ~ 2010  + as.numeric(년도) - 17,
`학교_학년` == "고등학교_3" ~ 2010  + as.numeric(년도) - 18,
.default =NA )) %>%
dplyr::mutate(생년 = factor(생년)) %>%
dplyr::select(-`년도`) %>%
dplyr::relocate(생년, .before = `학교_학년`) %>%
dplyr::arrange(`선택종목`, `생년`, `학교_학년`) %>%
dplyr::filter(생년 %in% c("2000","2001","2002","2003","2004"))#,"2005","2006","2007","2008","2009"))
birthyear_w<- birthyear %>%  pivot_wider(names_from = `학교_학년`, values_from = 전국평균)
write.xlsx(birthyear_w, file = here("data","outputs","birthyear_item_mean_female.xlsx"))
#| echo: false
#| warning: false
tvar <- test_item_levels[1]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar,"여성" )
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[2]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar,"여성" )
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[3]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar ,"여성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[4]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar ,"여성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[5]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar ,"여성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[6]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar ,"여성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[7]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar ,"여성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[8]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar,"여성" )
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[9]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar,"여성" )
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[10]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar ,"여성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[11]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar ,"여성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[12]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar ,"여성")
res[[1]]
res[[2]]
#| echo: false
tvar <- test_item_levels[13]
res <- summ_by_birthyear(birthyear,birthyear_w,tvar ,"여성")
res[[1]]
res[[2]]
knitr::opts_chunk$set(echo = FALSE, warning=FALSE, message=FALSE)
library(here)           # file pathways
source(here::here("_common", "common.R"))
source(here::here("_common", "preprocess.R"))
dirpath <- here("data","feather","paps_cd_summ.feather")
df_cd <- read_feather(dirpath, col_select = NULL, as_data_frame = TRUE, mmap = TRUE)
res <- summ_cd_plot_table_sex_all(df_cd, "FLX_EVL_CLA_CD", "남성", "유연성등급")
res[[1]]
if(isword) cat("\n", wordnewpage, "\n")
res[[2]]
if(isword) cat("\n", wordnewpage, "\n")
res[[3]]
res <- summ_cd_plot_table_sex_all(df_cd, "FLX_EVL_CLA_CD", "여성", "유연성등급")
res[[1]]
if(isword) cat("\n", wordnewpage, "\n")
res[[2]]
if(isword) cat("\n", wordnewpage, "\n")
res[[3]]
knitr::opts_chunk$set(echo = FALSE, warning=FALSE, message=FALSE)
library(here)           # file pathways
source(here::here("_common", "common.R"))
source(here::here("_common", "preprocess.R"))
dirpath <- here("data","feather","paps_cd_summ.feather")
df_cd <- read_feather(dirpath, col_select = NULL, as_data_frame = TRUE, mmap = TRUE)
res <- summ_cd_plot_table_sex_all(df_cd, "BDFAT_CLA_SCR_NM", "남성", "비만등급")
df_summ <- left_join(df_summ_n, df_summ_p, by=c("년도", "학교_학년"))
knitr::opts_chunk$set(echo = FALSE, warning=FALSE, message=FALSE)
library(here)           # file pathways
source(here::here("_common", "common.R"))
source(here::here("_common", "preprocess.R"))
dirpath <- here("data","feather","paps_cd_summ.feather")
df_cd <- read_feather(dirpath, col_select = NULL, as_data_frame = TRUE, mmap = TRUE)
res <- summ_cd_plot_table_sex_all(df_cd, "BDFAT_CLA_SCR_NM", "남성", "비만등급")
res[[1]]
if(isword) cat("\n", wordnewpage, "\n")
res[[2]]
if(isword) cat("\n", wordnewpage, "\n")
res[[3]]
res <- summ_cd_plot_table_sex_all(df_cd, "BDFAT_CLA_SCR_NM", "여성", "비만등급")
res[[1]]
if(isword) cat("\n", wordnewpage, "\n")
res[[2]]
if(isword) cat("\n", wordnewpage, "\n")
res[[3]]
View(var_paps_info)
